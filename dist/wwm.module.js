class e{constructor(e,t){this.type=e,this.value=t}static validate(t){return e.supported.indexOf(t.type)>-1&&("image"===t.type&&(t.value=`url(${t.value})`),!0)}static supported=["image","color"]}class t{constructor(e){this.name=e}}class s{constructor(e){this.listeners=e||[],this.eventsCallbacks={}}emit(e){for(let t=0,s=this.listeners.length;t<s;++t)this.listeners[t].trigger(e)}on(e,t){this.eventsCallbacks[e]||(this.eventsCallbacks[e]={}),this.eventsCallbacks[e].on=t}once(e,t){this.eventsCallbacks[e]||(this.eventsCallbacks[e]={}),this.eventsCallbacks[e].once=t}trigger(e){this.eventsCallbacks[e.name]&&this.eventsCallbacks[e.name].once&&(this.eventsCallbacks[e.name].once(e),this.eventsCallbacks[e.name].once=null),this.eventsCallbacks[e.name]&&this.eventsCallbacks[e.name].on&&this.eventsCallbacks[e.name].on(e)}subscribe(e){this.listeners.indexOf(e)<=-1&&this.listeners.push(e)}}var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),n=new Uint8Array(16);function a(){if(!i)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(n)}for(var r=[],l=0;l<256;++l)r.push((l+256).toString(16).substr(1));function h(e,t,s){"string"==typeof e&&(t="binary"===e?new Uint8Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){for(var n=s||0,l=0;l<16;++l)t[n+l]=i[l];return t}return function(e,t){var s=t||0,i=r;return(i[e[s+0]]+i[e[s+1]]+i[e[s+2]]+i[e[s+3]]+"-"+i[e[s+4]]+i[e[s+5]]+"-"+i[e[s+6]]+i[e[s+7]]+"-"+i[e[s+8]]+i[e[s+9]]+"-"+i[e[s+10]]+i[e[s+11]]+i[e[s+12]]+i[e[s+13]]+i[e[s+14]]+i[e[s+15]]).toLowerCase()}(i)}class o extends t{constructor(e,t){super(e),this.program=t}}class c extends s{constructor(e){super(),this.subscribe(this),this.subscribe(e),this.id=h(),this.name="Program",this.parent=e,this.args=[],this.events()}exec(...e){this.args=e,this.emit(new o("ProgramExec",this))}events(){}main(){this.end()}end(){this.emit(new o("ProgramEnd",this))}}class p extends t{constructor(e,t){super(e),this.wallpaper=t}}class u extends t{constructor(e,t){super(e);const s=getComputedStyle(t);this.screen={element:t,width:s.width,height:s.height}}}class m extends t{constructor(e,t){super(e),this.window=t}}class d extends s{constructor(e,t){super(),this.subscribe(this),this.program=e;t=Object.assign({},{x:0,y:0,width:100,height:100,titlebar:!1,visible:!0},t),this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.visible=t.visible,this.element=document.createElement("div"),this.program.parent.container.appendChild(this.element),this.__setupStyle(),this.__setupEvents(),this.events()}__setupStyle(){this.element.setAttribute("style",`\n\t\t\tposition: absolute;\n\t\t\ttop: ${this.y}px;\n\t\t\tleft: ${this.x}px;\n\t\t\twidth: ${this.width};\n\t\t\theight: ${this.height};\n\t\t\tvisible: ${this.visible};\n\t\t`)}__setupEvents(){}events(){}render(e){this.element.innerHTML=e}resize(e,t){this.width=e,this.height=t,this.element.style.width=this.width,this.element.style.height=this.height,this.emit(new m("WindowResize",this))}}class g extends c{constructor(e){super(e),this.name="WWMWallpaper"}main(){let e=this.args[0],t=this.args[1];this.parent.subscribe(this);const s=getComputedStyle(this.parent.container);this.mainWindow=new d(this,{x:0,y:0,width:s.width,height:s.height}),this.mainWindow.element.style.backgroundSize="cover",this.mainWindow.element.style.backgroundPosition="center center",this.setWallpaper(e,t)}events(){this.on("ScreenResize",e=>{this.mainWindow.resize(e.screen.width,e.screen.height)}),this.on("WallpaperChange",e=>{switch(e.wallpaper.type){case"image":this.mainWindow.element.style.backgroundImage=e.wallpaper.value;break;case"color":this.mainWindow.element.style.backgroundColor=e.wallpaper.value}})}setWallpaper(t,s){let i=new e(t,s);e.validate(i)&&this.emit(new p("WallpaperChange",i))}}var v={WWM:class extends s{constructor(e){super(),this.subscribe(this);this.options=Object.assign({},{tiling:"floating",container:null},e),this.container=this.options.container?document.querySelector(this.options.container):document.body,this.container.style.position="relative",this.container.style.overflow="hidden",this.programs=[],this.__setupEvents(),this.__setupPrograms()}__setupEvents(){this.on("ProgramExec",e=>{this.programs.push(e.program),e.program.main()}),window.addEventListener("resize",()=>{this.emit(new u("ScreenResize",this.container))})}__setupPrograms(){this.exec(new g(this),"color","#000000")}exec(e,...t){e.parent=this,e.subscribe(this),e.args=t,this.emit(new o("ProgramExec",e))}setWallpaper(t,s){let i=new e(t,s);e.validate(i)&&this.emit(new p("WallpaperChange",i))}},Program:c,Window:d,EventEmitter:class{constructor(e){this.listeners=e||[]}emit(e){for(let t=0,s=this.listeners.length;t<s;++t)this.listeners[t].trigger(e)}subscribe(e){this.listeners.indexOf(e)<=-1&&this.listeners.push(e)}},EventListener:class{constructor(){this.eventsCallbacks={}}on(e,t){this.eventsCallbacks[e]||(this.eventsCallbacks[e]={}),this.eventsCallbacks[e].on=t}once(e,t){this.eventsCallbacks[e]||(this.eventsCallbacks[e]={}),this.eventsCallbacks[e].once=t}trigger(e){this.eventsCallbacks[e.name]&&this.eventsCallbacks[e.name].once&&(this.eventsCallbacks[e.name].once(e),this.eventsCallbacks[e.name].once=null),this.eventsCallbacks[e.name]&&this.eventsCallbacks[e.name].on&&this.eventsCallbacks[e.name].on(e)}},EventHandler:s,WWMEvent:t,WallpaperEvent:p,ProgramEvent:o,Wallpaper:e};export default v;
//# sourceMappingURL=wwm.module.js.map
