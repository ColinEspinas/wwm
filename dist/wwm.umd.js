!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s(require("shortid")):"function"==typeof define&&define.amd?define(["shortid"],s):(e=e||self).wwm=s(e.shortid)}(this,(function(e){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;class s{constructor(e,s){this.type=e,this.value=s}static validate(e){return s.supported.indexOf(e.type)>-1}static supported=["image","color"]}class t{constructor(e){this.name=e}}class n{constructor(e){this.listeners=e||[],this.eventsCallbacks={}}emit(e){for(let s=0,t=this.listeners.length;s<t;++s)this.listeners[s].trigger(e)}on(e,s){this.eventsCallbacks[e].on=s}once(e,s){this.eventsCallbacks[e].once=s}trigger(e){console.log(this.eventsCallbacks),this.eventsCallbacks[e.name]&&this.eventsCallbacks[e.name].once&&(this.eventsCallbacks[e.name].once(e),this.eventsCallbacks[e.name].once=null),this.eventsCallbacks[e.name]&&this.eventsCallbacks[e.name].on&&this.eventsCallbacks[e.name].on(e)}subscribe(e){this.listeners.push(e)}}class a extends t{constructor(e,s){super(e),this.program=s}}class l extends t{constructor(e,s){super(e),this.wallpaper=s}}return{WWM:class extends n{constructor(e){super([this]);this.options=Object.assign({},{tiling:"floating",container:null},e),this.container=this.options.container?document.querySelector(this.options.container):document.body,this.programs=[],__setupEvents()}__setupEvents(){this.on("ProgramExec",e=>{this.programs.push(program),program.main()}),this.on("wallpaperChange",e=>{this.wallpaper=e.wallpaper})}exec(e){e.parent=this,e.subscribe(this),this.emit(new a("ProgramExec",e))}setWallpaper(e,t){let n=new s(e,t);s.validate(n)&&this.emit(new l("wallpaperChange",n))}},EventEmitter:class{constructor(e){this.listeners=e||[]}emit(e){for(let s=0,t=this.listeners.length;s<t;++s)this.listeners[s].trigger(e)}subscribe(e){this.listeners.push(e)}},EventListener:class{constructor(){this.eventsCallbacks={}}on(e,s){this.eventsCallbacks[e].on=s}once(e,s){this.eventsCallbacks[e].once=s}trigger(e){console.log(this.eventsCallbacks),this.eventsCallbacks[e.name]&&this.eventsCallbacks[e.name].once&&(this.eventsCallbacks[e.name].once(e),this.eventsCallbacks[e.name].once=null),this.eventsCallbacks[e.name]&&this.eventsCallbacks[e.name].on&&this.eventsCallbacks[e.name].on(e)}},EventHandler:n,WWMEvent:t,WallpaperEvent:l,Wallpaper:s}}));
